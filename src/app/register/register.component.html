<button class="btn-back" (click)="regresar()">Regresar</button>

<div class="register-container">
  <h2>Registro de Usuario</h2>
  <form (ngSubmit)="onRegister()" #registerForm="ngForm">
    <div class="form-group">
      <label for="email">Correo electrónico</label>
      <input
        type="email"
        id="email"
        [(ngModel)]="email"
        name="email"
        placeholder="Ingresa tu correo electrónico"
        required
        email
      />
      <div *ngIf="registerForm.controls['email']?.invalid && registerForm.controls['email']?.touched" class="error-message">
        El correo electrónico es inválido.
      </div>
    </div>

    <div class="form-group">
      <label for="password">Contraseña</label>
      <input
        type="password"
        id="password"
        [(ngModel)]="password"
        name="password"
        placeholder="Ingresa tu contraseña"
        required
        minlength="6"
      />
      <div *ngIf="registerForm.controls['password']?.invalid && registerForm.controls['password']?.touched" class="error-message">
        La contraseña debe tener al menos 6 caracteres.
      </div>
    </div>

    <div class="form-group">
      <label for="role">Rol</label>
      <select id="role" [(ngModel)]="role" name="role" required>
        <option value="empleado">Empleado</option>
        <option value="almacenista">Almacenista</option>
      </select>
    </div>

    <button type="submit" [disabled]="registerForm.invalid">Registrar</button>
  </form>
</div>

<!-- Botón para abrir el modal de usuarios -->
<button class="btn-view-users" (click)="abrirModalUsuarios()">Ver Usuarios</button>

<!-- Modal de usuarios -->
<div *ngIf="modalUsuariosAbierto" class="modal">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <span (click)="cerrarModalUsuarios()" class="close">&times;</span>
    <h2>Usuarios Registrados</h2>
    <table class="user-table">
      <thead>
        <tr>
          <th>Correo Electrónico</th>
          <th>Rol</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of usuarios">
          <td>{{ user.email }}</td>
          <td>{{ user.role }}</td>
          <td>
            <button class="action-button edit" (click)="abrirModalEditar(user)">Editar</button>
            <button class="action-button delete" (click)="confirmarEliminacion(user._id)">Eliminar</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Modal de edición -->
<div *ngIf="modalEditarAbierto" class="modal">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <span (click)="cerrarModalEditar()" class="close">&times;</span>
    <h2>Editar Usuario</h2>
    <form (ngSubmit)="onEditarUsuario()" #editarForm="ngForm">
      <div class="form-group">
        <label for="edit-email">Correo electrónico</label>
        <input
          type="email"
          id="edit-email"
          [(ngModel)]="usuarioEditado.email"
          name="email"
          placeholder="Ingresa el correo electrónico"
          required
          email
        />
        <div *ngIf="editarForm.controls['email']?.invalid && editarForm.controls['email']?.touched" class="error-message">
          El correo electrónico es inválido.
        </div>
      </div>

      <div class="form-group">
        <label for="edit-role">Rol</label>
        <select id="edit-role" [(ngModel)]="usuarioEditado.role" name="role" required>
          <option value="empleado">Empleado</option>
          <option value="almacenista">Almacenista</option>
        </select>
      </div>

      <button type="submit" [disabled]="editarForm.invalid">Guardar Cambios</button>
    </form>
  </div>
</div>